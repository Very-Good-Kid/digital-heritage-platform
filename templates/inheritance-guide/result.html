{% extends "base.html" %}

{% block title %}继承导航结果 - 数字遗产继承平台{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row mb-4">
        <div class="col-12">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('inheritance_guide') }}">继承导航</a></li>
                    <li class="breadcrumb-item active">导航结果</li>
                </ol>
            </nav>
        </div>
    </div>

    <!-- 平台专属合规说明 -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0"><i class="bi bi-shield-check"></i> {{ platform }}数字遗产继承全场景指引</h5>
        </div>
        <div class="card-body">
            <div class="alert alert-warning mb-3">
                <h6 class="alert-heading"><i class="bi bi-exclamation-triangle"></i> 【平台专属合规说明】</h6>
                <ol class="mb-0">
                    <li class="mb-2">
                        <strong>可继承范围：</strong>
                        {% if platform == 'QQ' %}
                        QQ账号内的财产性权益，包括QQ钱包余额、理财通资产、Q币、腾讯系游戏道具/装备、付费会员可转移权益、可变现原创数字内容等；QQ账号所有权归属腾讯科技（深圳）有限公司，用户离世后账号不支持继承、过户，仅可按规则处置对应资产。
                        {% elif platform == '微信' %}
                        微信账号内的财产性权益，包括微信支付余额、理财通资产、微信零钱通、视频号创作收益、公众号相关可变现资产、付费会员可转移权益等；微信账号所有权归属腾讯科技（深圳）有限公司，用户离世后账号将被回收，不支持账号继承、过户、转移。
                        {% elif platform == '抖音' %}
                        抖音账号内的财产性权益，包括抖币余额、直播带货收益、电商橱窗资产、创作收入、付费课程可转移权益、本地生活可核销权益等；抖音账号所有权归属北京字节跳动网络技术有限公司，用户离世后账号将按规则处置，不支持账号继承、过户、转移。
                        {% endif %}
                    </li>
                    <li class="mb-2">
                        <strong>官方唯一认可受理渠道：</strong>
                        {% if platform == 'QQ' %}
                        腾讯官方客服专线4006700700、腾讯客服官网（kf.qq.com）、微信/QQ端「腾讯客服」小程序。
                        {% elif platform == '微信' %}
                        微信支付专属客服专线95017、微信APP内「我-设置-帮助与反馈」、微信/QQ端「腾讯客服」小程序。
                        {% elif platform == '抖音' %}
                        抖音官方客服专线95152、抖音APP内「我-设置-反馈与帮助」、抖音安全中心官方渠道。
                        {% endif %}
                    </li>
                </ol>
            </div>
        </div>
    </div>

    <!-- 场景定义和核心合规提示 -->
    <div class="card mb-4">
        <div class="card-header">
            <h5><i class="bi bi-compass"></i> 场景精准定义</h5>
        </div>
        <div class="card-body">
            <p class="mb-3">
                <strong>当前场景：</strong>
                {% if scenario == 'scenario1' %}
                有合法有效遗嘱 + 持有账号有效登录密码
                {% elif scenario == 'scenario2' %}
                有合法有效遗嘱 + 无账号有效登录密码
                {% else %}
                无合法有效遗嘱（法定继承） + 无账号有效登录密码
                {% endif %}
            </p>
            <p class="text-muted">
                本场景适用于：逝者
                {% if scenario == 'scenario1' %}
                生前订立了符合《民法典》规定的合法有效遗嘱，遗嘱中明确对{{ platform }}账号内数字遗产作出了分配安排、指定了对应继承人，且继承人已获取该{{ platform }}账号的有效登录密码的继承场景。
                {% elif scenario == 'scenario2' %}
                生前订立了符合《中华人民共和国民法典》规定的合法有效遗嘱，遗嘱中明确对{{ platform }}账号内数字遗产作出了清晰的分配安排、指定了对应继承人，但继承人未获取逝者{{ platform }}账号的有效登录密码，无法直接登录账号处置相关资产的继承场景。
                {% else %}
                生前未订立符合法律规定的有效遗嘱，需按照《民法典》法定继承规则处置{{ platform }}账号内数字遗产，且继承人未获取账号有效登录密码的继承场景。
                {% endif %}
            </p>
        </div>
    </div>

    <!-- 详细操作步骤 -->
    <div class="card mb-4">
        <div class="card-header">
            <h5><i class="bi bi-list-ol"></i> 详细操作步骤</h5>
        </div>
        <div class="card-body">
            {% for step in steps %}
            <div class="step-item mb-5">
                <div class="step-number">{{ step.step }}</div>
                <div class="step-content">
                    <div class="step-title">{{ step.title }}</div>
                    <p>{{ step.description }}</p>

                    <!-- 场景核心合规提示 -->
                    {% if step.warning %}
                    <div class="alert alert-danger mt-3">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        {{ step.warning|safe }}
                    </div>
                    {% endif %}

                    <!-- 沟通核心事项 -->
                    {% if step.communication_points %}
                    <h6 class="mt-3"><i class="bi bi-chat-dots"></i> 沟通核心事项</h6>
                    <ol class="communication-points">
                        {% for point in step.communication_points %}
                        <li>{{ point }}</li>
                        {% endfor %}
                    </ol>
                    {% endif %}

                    <!-- 操作指引 -->
                    {% if step.instructions %}
                    <h6 class="mt-3"><i class="bi bi-list-check"></i> 操作指引</h6>
                    <ol class="instructions">
                        {% for instruction in step.instructions %}
                        <li>{{ instruction }}</li>
                        {% endfor %}
                    </ol>
                    {% endif %}

                    <!-- 材料准备清单 -->
                    {% if step.materials %}
                    <h6 class="mt-3"><i class="bi bi-file-earmark-text"></i> 材料准备清单</h6>
                    <table class="table table-bordered material-table">
                        <thead>
                            <tr>
                                <th style="width: 30%">材料类型</th>
                                <th>具体明细</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for material in step.materials %}
                            <tr>
                                <td><strong>核心必备材料</strong></td>
                                <td>{{ material }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% endif %}

                    <!-- 法律维权途径 -->
                    {% if step.legal_actions %}
                    <h6 class="mt-3"><i class="bi bi-gavel"></i> 法律维权途径</h6>
                    <ol class="legal-actions">
                        {% for action in step.legal_actions %}
                        <li>{{ action }}</li>
                        {% endfor %}
                    </ol>
                    {% endif %}

                    <!-- 审核结果处置 -->
                    {% if step.outcome_handling %}
                    <h6 class="mt-3"><i class="bi bi-check-circle"></i> 审核结果处置</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="alert alert-success">
                                <h6 class="alert-heading"><i class="bi bi-check-circle-fill"></i> 审核通过处置</h6>
                                <ol class="mb-0">
                                    {% for outcome in step.outcome_handling.approved %}
                                    <li>{{ outcome }}</li>
                                    {% endfor %}
                                </ol>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="alert alert-danger">
                                <h6 class="alert-heading"><i class="bi bi-x-circle-fill"></i> 审核驳回处置</h6>
                                <ol class="mb-0">
                                    {% for outcome in step.outcome_handling.rejected %}
                                    <li>{{ outcome }}</li>
                                    {% endfor %}
                                </ol>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- 配套可下载模板 -->
                    {% if step.templates %}
                    <div class="templates-section mt-3">
                        <h6><i class="bi bi-download"></i> 配套可下载模板（以最终模板合集为准）</h6>
                        <div class="row">
                            {% for template in step.templates %}
                            <div class="col-md-4 mb-2">
                                <a href="{{ url_for('download_inheritance_template', template_name=template) }}" class="btn btn-outline-primary btn-sm w-100">
                                    <i class="bi bi-file-earmark-pdf"></i> {{ template }}
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- 官方联系渠道 -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h6><i class="bi bi-telephone"></i> 官方联系渠道</h6>
                </div>
                <div class="card-body">
                    <p><i class="bi bi-telephone-fill"></i> 客服电话：<strong>{{ policy.customer_service }}</strong></p>
                    <p class="text-muted small">建议在工作时间拨打，准备好相关材料和信息</p>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h6><i class="bi bi-exclamation-triangle"></i> 重要提醒</h6>
                </div>
                <div class="card-body">
                    <p class="text-danger small">{{ policy.risk_warning }}</p>
                    <p class="text-muted small">继承过程可能需要较长时间，请保持耐心并准备好所有必要材料</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 法律依据 -->
    <div class="card mb-4">
        <div class="card-header">
            <h6><i class="bi bi-gavel"></i> 法律依据</h6>
        </div>
        <div class="card-body">
            <p class="mb-0">{{ policy.legal_basis }}</p>
        </div>
    </div>

    <!-- 操作按钮 -->
    <div class="d-flex justify-content-between mt-4">
        <a href="{{ url_for('inheritance_guide') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> 返回重新选择
        </a>
        <button onclick="window.print()" class="btn btn-primary">
            <i class="bi bi-printer"></i> 打印/保存此页面
        </button>
    </div>
</div>
{% endblock %}
