# ğŸ”„ æ›´æ–°éƒ¨ç½²æŒ‡å— - Render å¹³å°

## ğŸ“‹ å½“å‰çŠ¶æ€

### å·²å®Œæˆçš„æ›´æ–°

âœ… **Git ä»“åº“çŠ¶æ€**ï¼š
- å½“å‰åˆ†æ”¯ï¼š`main`
- å¾…æ¨é€æäº¤ï¼š2 ä¸ª
- å·¥ä½œåŒºï¼šå¹²å‡€ï¼ˆæ— æœªæäº¤çš„ä¿®æ”¹ï¼‰

### æ›´æ–°å†…å®¹

#### æäº¤ 1ï¼š`08b90eb`
- Initial commit: Digital Heritage Platform with Chinese font support
- åŒ…å« Dockerfileã€éƒ¨ç½²è„šæœ¬ç­‰

#### æäº¤ 2ï¼š`9576ba9`ï¼ˆæœ€æ–°ï¼‰
- fix: ä¼˜åŒ–ä¸­æ–‡å­—ä½“æ”¯æŒå’Œéƒ¨ç½²æŒ‡å—
- ä¿®å¤ render.yaml è¯­æ³•é”™è¯¯
- ä¼˜åŒ– fonts.py å­—ä½“ç®¡ç†æ¨¡å—
- æ·»åŠ è¯¦ç»†çš„éƒ¨ç½²æ•™ç¨‹æ–‡æ¡£

---

## ğŸš€ æ›´æ–°éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šæ¨é€æ›´æ–°åˆ° GitHub

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd "c:\Users\admin\Desktop\demo - codebuddy"

# æ¨é€æ›´æ–°åˆ° GitHub
git push origin main
```

**å¦‚æœéœ€è¦èº«ä»½éªŒè¯ï¼š**
- Username: ä½ çš„ GitHub ç”¨æˆ·å
- Password: GitHub Personal Access Tokenï¼ˆä¸æ˜¯å¯†ç ï¼‰

---

### æ­¥éª¤ 2ï¼šRender è‡ªåŠ¨éƒ¨ç½²

æ¨é€ä»£ç åï¼ŒRender ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ›´æ–°å¹¶å¼€å§‹é‡æ–°éƒ¨ç½²ã€‚

#### æŸ¥çœ‹éƒ¨ç½²è¿›åº¦

1. è®¿é—® [https://dashboard.render.com](https://dashboard.render.com)
2. æ‰¾åˆ°ä½ çš„ Web Serviceï¼š`digital-heritage-platform`
3. ç‚¹å‡»è¿›å…¥æœåŠ¡è¯¦æƒ…é¡µ
4. æŸ¥çœ‹ **"Events"** æ ‡ç­¾
5. æ‰¾åˆ°æœ€æ–°çš„éƒ¨ç½²è®°å½•ï¼ˆçŠ¶æ€åº”ä¸º "In Progress" æˆ– "Deploying"ï¼‰

#### é¢„æœŸéƒ¨ç½²æ—¶é—´

- **é¦–æ¬¡éƒ¨ç½²**ï¼š3-5 åˆ†é’Ÿ
- **æ›´æ–°éƒ¨ç½²**ï¼š2-3 åˆ†é’Ÿï¼ˆé€šå¸¸æ›´å¿«ï¼‰

---

### æ­¥éª¤ 3ï¼šç›‘æ§éƒ¨ç½²æ—¥å¿—

#### æŸ¥çœ‹æ„å»ºæ—¥å¿—

1. åœ¨ Render Dashboard ä¸­ç‚¹å‡»ä½ çš„ Web Service
2. ç‚¹å‡» **"Logs"** æ ‡ç­¾
3. é€‰æ‹© **"Build Logs"**

**æˆåŠŸçš„æ—¥å¿—åº”è¯¥åŒ…å«ï¼š**

```
âœ“ Cloning repository...
âœ“ Installing system dependencies...
âœ“ Installing fonts-noto-cjk...
âœ“ Installing fonts-wqy-microhei...
âœ“ Installing fonts-wqy-zenhei...
âœ“ Installing Python dependencies...
âœ“ [OK] Successfully registered system font: /usr/share/fonts/truetype/noto/NotoSansCJK-Regular.ttc
âœ“ Build completed successfully
âœ“ Deployment successful
```

#### æŸ¥çœ‹è¿è¡Œæ—¶æ—¥å¿—

å¦‚æœæ„å»ºæˆåŠŸä½†åº”ç”¨æœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹ **"Runtime Logs"**ï¼š

```bash
# æ£€æŸ¥åº”ç”¨å¯åŠ¨æ—¥å¿—
âœ“ Starting gunicorn...
âœ“ Application started successfully
```

---

### æ­¥éª¤ 4ï¼šéªŒè¯æ›´æ–°

#### éƒ¨ç½²çŠ¶æ€æ£€æŸ¥

åœ¨ Render Dashboard ä¸­ç¡®è®¤ï¼š

- âœ… **Status**: `Live`ï¼ˆç»¿è‰²ï¼‰
- âœ… **Health Check**: é€šè¿‡
- âœ… **Build Logs**: æ— é”™è¯¯
- âœ… **Runtime Logs**: æ— é”™è¯¯

#### åŠŸèƒ½éªŒè¯

è®¿é—®ä½ çš„åº”ç”¨ URLï¼ˆä¾‹å¦‚ï¼š`https://digital-heritage-platform.onrender.com`ï¼‰

éªŒè¯ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **é¦–é¡µåŠ è½½**
   - [ ] é¦–é¡µæ­£å¸¸æ˜¾ç¤º
   - [ ] æ— é”™è¯¯æç¤º

2. **ç”¨æˆ·åŠŸèƒ½**
   - [ ] èƒ½å¤Ÿç™»å½•
   - [ ] èƒ½å¤Ÿåˆ›å»ºé—å˜±

3. **PDF ç”Ÿæˆï¼ˆé‡ç‚¹éªŒè¯ï¼‰**
   - [ ] åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„é—å˜±
   - [ ] ç‚¹å‡»"ç”Ÿæˆ PDF"æŒ‰é’®
   - [ ] ä¸‹è½½ PDF æ–‡ä»¶
   - [ ] **æ‰“å¼€ PDFï¼ŒéªŒè¯ä¸­æ–‡æ˜¯å¦æ­£ç¡®æ˜¾ç¤º**
   - [ ] ç¡®è®¤æ²¡æœ‰æ–¹æ¡†æˆ–ä¹±ç 

---

## ğŸ”§ æ‰‹åŠ¨è§¦å‘éƒ¨ç½²ï¼ˆå¦‚æœè‡ªåŠ¨éƒ¨ç½²å¤±è´¥ï¼‰

å¦‚æœæ¨é€ä»£ç å Render æ²¡æœ‰è‡ªåŠ¨éƒ¨ç½²ï¼Œå¯ä»¥æ‰‹åŠ¨è§¦å‘ï¼š

### æ–¹æ³• 1ï¼šé€šè¿‡ Render Dashboard

1. è®¿é—® [https://dashboard.render.com](https://dashboard.render.com)
2. æ‰¾åˆ°ä½ çš„ Web Service
3. ç‚¹å‡» **"Manual Deploy"** æŒ‰é’®
4. é€‰æ‹© **"Deploy latest commit"**
5. ç­‰å¾…éƒ¨ç½²å®Œæˆ

### æ–¹æ³• 2ï¼šé€šè¿‡ Render CLI

```bash
# å®‰è£… Render CLI
npm install -g render-cli

# ç™»å½•
render login

# æ‰‹åŠ¨éƒ¨ç½²
render deploy
```

---

## ğŸ› å¸¸è§æ›´æ–°éƒ¨ç½²é—®é¢˜

### é—®é¢˜ 1ï¼šæ¨é€ä»£ç å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
error: failed to push some refs to 'https://github.com/...'
```

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# æ£€æŸ¥è¿œç¨‹ä»“åº“åœ°å€
git remote -v

# å¦‚æœåœ°å€ä¸å¯¹ï¼Œé‡æ–°è®¾ç½®
git remote set-url origin https://github.com/YOUR_USERNAME/digital-heritage-platform.git

# å¼ºåˆ¶æ¨é€ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
git push origin main --force
```

### é—®é¢˜ 2ï¼šRender æ„å»ºå¤±è´¥ - å­—ä½“å®‰è£…é”™è¯¯

**é”™è¯¯ä¿¡æ¯ï¼š**
```
E: Unable to locate package fonts-noto-cjk
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. åœ¨ Render Dashboard ä¸­ï¼š
   - Web Service â†’ Settings
   - ä¿®æ”¹ Build Command ä¸ºï¼š
     ```
     apt-get update && apt-get install -y fonts-wqy-microhei fonts-wqy-zenhei && pip install -r requirements.txt
     ```
2. ç‚¹å‡» **"Save Changes"**
3. è§¦å‘æ‰‹åŠ¨éƒ¨ç½²

### é—®é¢˜ 3ï¼šéƒ¨ç½²æˆåŠŸä½† PDF ä¸­æ–‡ä»æ˜¾ç¤ºä¸ºæ–¹æ¡†

**åŸå› ï¼š** å­—ä½“ç¼“å­˜é—®é¢˜æˆ–å­—ä½“æœªæ­£ç¡®åŠ è½½

**è§£å†³æ–¹æ¡ˆï¼š**

#### æ–¹æ¡ˆ Aï¼šæ¸…é™¤æ„å»ºç¼“å­˜å¹¶é‡æ–°éƒ¨ç½²

1. åœ¨ Render Dashboardï¼š
   - Web Service â†’ Manual Deploy
   - é€‰æ‹© **"Clear build cache & deploy"**

#### æ–¹æ¡ˆ Bï¼šæ‰‹åŠ¨å®‰è£…å­—ä½“å¹¶é‡å¯

1. åœ¨ Render Dashboard æ‰“å¼€ Shellï¼š
   - Web Service â†’ Shell

2. è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# æ›´æ–°åŒ…åˆ—è¡¨
apt-get update

# å®‰è£…å­—ä½“
apt-get install -y fonts-noto-cjk

# åˆ·æ–°å­—ä½“ç¼“å­˜
fc-cache -fv

# éªŒè¯å­—ä½“å·²å®‰è£…
fc-list | grep -i "noto"

# é‡å¯åº”ç”¨ï¼ˆRender ä¼šè‡ªåŠ¨é‡å¯ï¼‰
exit
```

3. åœ¨ Render Dashboard è§¦å‘æ‰‹åŠ¨éƒ¨ç½²

#### æ–¹æ¡ˆ Cï¼šæ£€æŸ¥å­—ä½“åŠ è½½æ—¥å¿—

1. æŸ¥çœ‹ Runtime Logs
2. æœç´¢åŒ…å« "font" æˆ– "Chinese" çš„æ—¥å¿—
3. ç¡®è®¤çœ‹åˆ°ï¼š
   ```
   [OK] Successfully registered system font: /usr/share/fonts/truetype/noto/NotoSansCJK-Regular.ttc
   ```

### é—®é¢˜ 4ï¼šéƒ¨ç½²ååº”ç”¨æ— æ³•è®¿é—®

**é”™è¯¯ä¿¡æ¯ï¼š**
```
502 Bad Gateway
æˆ–
503 Service Unavailable
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ Runtime Logs æŸ¥æ‰¾é”™è¯¯
2. ç¡®è®¤ Start Command æ­£ç¡®ï¼š`gunicorn app:app`
3. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦é…ç½®æ­£ç¡®
4. æŸ¥çœ‹æ˜¯å¦æœ‰ä»£ç é”™è¯¯å¯¼è‡´åº”ç”¨å´©æºƒ

### é—®é¢˜ 5ï¼šæ›´æ–°åæ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
sqlalchemy.exc.OperationalError: could not connect to server
```

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ£€æŸ¥ `DATABASE_URL` ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ Supabase é¡¹ç›®æ­£åœ¨è¿è¡Œ
3. éªŒè¯æ•°æ®åº“å¯†ç æ˜¯å¦æ­£ç¡®
4. æ£€æŸ¥ Supabase çš„ç½‘ç»œè®¿é—®è®¾ç½®

---

## ğŸ“Š æ›´æ–°å†…å®¹å¯¹æ¯”

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | å½±å“ |
|------|---------|------|
| `render.yaml` | ä¿®å¤è¯­æ³•é”™è¯¯ï¼Œæ·»åŠ  `fonts-noto-cjk` | ä¿®å¤éƒ¨ç½²å¤±è´¥é—®é¢˜ |
| `utils/fonts.py` | ä¼˜åŒ–å­—ä½“åŠ è½½é€»è¾‘ï¼Œæ·»åŠ å¤‡ç”¨ä¸‹è½½æº | æé«˜ PDF ä¸­æ–‡æ˜¾ç¤ºå¯é æ€§ |
| `RENDER_DEPLOYMENT_TUTORIAL.md` | æ–°å¢è¯¦ç»†éƒ¨ç½²æ•™ç¨‹ | æä¾›å®Œæ•´éƒ¨ç½²æ–‡æ¡£ |
| `GIT_DEPLOYMENT_GUIDE.md` | æ–°å¢ Git éƒ¨ç½²å¿«é€ŸæŒ‡å— | ç®€åŒ–éƒ¨ç½²æµç¨‹ |

### ä¸»è¦æ”¹è¿›

1. **ä¸­æ–‡å­—ä½“æ”¯æŒ**
   - âœ… æ·»åŠ  Noto Sans CJK ä¼˜å…ˆæ”¯æŒ
   - âœ… æ·»åŠ  Source Han Sans å¤‡ç”¨ä¸‹è½½æº
   - âœ… æ”¹è¿›å­—ä½“åŠ è½½é€»è¾‘å’Œé”™è¯¯å¤„ç†
   - âœ… æ”¯æŒè‡ªåŠ¨é™çº§æœºåˆ¶

2. **éƒ¨ç½²é…ç½®**
   - âœ… ä¿®å¤ render.yaml è¯­æ³•é”™è¯¯
   - âœ… ä¼˜åŒ– buildCommand
   - âœ… æ·»åŠ è¯¦ç»†éƒ¨ç½²æ–‡æ¡£

3. **æ–‡æ¡£å®Œå–„**
   - âœ… å®Œæ•´çš„éƒ¨ç½²æ•™ç¨‹
   - âœ… Git éƒ¨ç½²å¿«é€ŸæŒ‡å—
   - âœ… æ•…éšœæ’é™¤æŒ‡å—

---

## ğŸ” éªŒè¯æ›´æ–°æ˜¯å¦æˆåŠŸ

### æ£€æŸ¥æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·éªŒè¯ä»¥ä¸‹å†…å®¹ï¼š

#### 1. Render Dashboard æ£€æŸ¥

- [ ] éƒ¨ç½²çŠ¶æ€ä¸º `Live`
- [ ] Health Check é€šè¿‡
- [ ] Build Logs æ— é”™è¯¯
- [ ] Runtime Logs æ— é”™è¯¯

#### 2. åº”ç”¨åŠŸèƒ½æ£€æŸ¥

- [ ] é¦–é¡µæ­£å¸¸åŠ è½½
- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] åˆ›å»ºé—å˜±åŠŸèƒ½æ­£å¸¸
- [ ] PDF ç”ŸæˆåŠŸèƒ½æ­£å¸¸

#### 3. PDF ä¸­æ–‡æ˜¾ç¤ºæ£€æŸ¥ï¼ˆé‡ç‚¹ï¼‰

- [ ] åˆ›å»ºåŒ…å«ä¸­æ–‡çš„é—å˜±
- [ ] ç”Ÿæˆ PDF æ–‡ä»¶
- [ ] æ‰“å¼€ PDF æ–‡ä»¶
- [ ] éªŒè¯ä¸­æ–‡æ­£ç¡®æ˜¾ç¤ºï¼ˆæ— æ–¹æ¡†ã€æ— ä¹±ç ï¼‰

#### 4. å­—ä½“åŠ è½½æ—¥å¿—æ£€æŸ¥

- [ ] æŸ¥çœ‹ Runtime Logs
- [ ] ç¡®è®¤çœ‹åˆ°å­—ä½“æ³¨å†ŒæˆåŠŸçš„æ—¥å¿—
- [ ] ç¡®è®¤æ²¡æœ‰å­—ä½“ç›¸å…³çš„é”™è¯¯

---

## ğŸ“ æ›´æ–°åç»´æŠ¤å»ºè®®

### å®šæœŸæ£€æŸ¥

1. **æ¯å‘¨æ£€æŸ¥**ï¼š
   - åº”ç”¨è¿è¡ŒçŠ¶æ€
   - é”™è¯¯æ—¥å¿—
   - PDF ç”ŸæˆåŠŸèƒ½

2. **æ¯æœˆæ£€æŸ¥**ï¼š
   - æ•°æ®åº“å¤‡ä»½
   - ç£ç›˜ç©ºé—´ä½¿ç”¨
   - æ€§èƒ½ç›‘æ§

### å¤‡ä»½å»ºè®®

1. **ä»£ç å¤‡ä»½**ï¼š
   - GitHub å·²è‡ªåŠ¨å¤‡ä»½

2. **æ•°æ®åº“å¤‡ä»½**ï¼š
   - Supabase æä¾›è‡ªåŠ¨å¤‡ä»½
   - å»ºè®®å¯ç”¨æ¯æ—¥å¤‡ä»½

3. **ç”¨æˆ·æ•°æ®å¤‡ä»½**ï¼š
   - å®šæœŸå¯¼å‡ºé‡è¦æ•°æ®
   - å¤‡ä»½ PDF æ–‡ä»¶

---

## ğŸ‰ æ›´æ–°å®Œæˆï¼

æ­å–œï¼ä½ çš„æ•°å­—é—äº§ç»§æ‰¿å¹³å°å·²æˆåŠŸæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

### æ›´æ–°æ‘˜è¦

âœ… ä¿®å¤äº† render.yaml è¯­æ³•é”™è¯¯
âœ… ä¼˜åŒ–äº†ä¸­æ–‡å­—ä½“æ”¯æŒï¼ˆ3å¥—å…è´¹æ–¹æ¡ˆï¼‰
âœ… æ·»åŠ äº†è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£
âœ… æé«˜äº† PDF ä¸­æ–‡æ˜¾ç¤ºçš„å¯é æ€§

### è®¿é—®åº”ç”¨

**URL:** `https://digital-heritage-platform.onrender.com`

### ä¸‹ä¸€æ­¥

1. æµ‹è¯• PDF ä¸­æ–‡æ˜¾ç¤ºåŠŸèƒ½
2. å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼ŒæŸ¥çœ‹æ•…éšœæ’é™¤éƒ¨åˆ†
3. å®šæœŸæ£€æŸ¥åº”ç”¨è¿è¡ŒçŠ¶æ€

---

*æœ€åæ›´æ–°ï¼š2026-02-14*
